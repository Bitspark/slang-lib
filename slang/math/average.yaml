# Average: calculates average value
---
in:
  type: stream
  stream:
    type: number
out:
  type: number
properties:
  - zeroValue

operators:
  sum:
    operator: .sum_reduce
  length:
    operator: slang.stream.length_reduce
    generics:
      itemType:
        type: number
  div:
    operator: slang.eval
    generics:
      paramsMap:
        type: map
        map:
          sum:
            type: number
          length:
            type: number
    properties:
      expression: sum/length
  zeroval:
    operator: slang.const
    generics:
      valueType:
        type: primitive
    properties:
      value: $zeroValue
  gtzero:
    operator: slang.eval
    generics:
      paramsMap:
        type: map
        map:
          length:
            type: number
    properties:
      expression: length > 0
  switch:
    operator: slang.syncMerge
    generics:
      itemType:
        type: primitive

connections:
  (:
  - (sum
  - (length
  sum):
  - sum(div
  length):
  - length(div
  - (zeroval
  - length(gtzero
  gtzero):
  - select(switch
  zeroval):
  - false(switch
  div):
  - true(switch
  switch):
  - )
