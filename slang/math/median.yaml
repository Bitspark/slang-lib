# Median: calculates median value
---
in:
  type: stream
  stream:
    type: number
out:
  type: number

operators:
  # Sort the stream
  sorter:
    operator: slang.stream.mergeSort
  # Get length of stream
  length:
    operator: slang.stream.length
    generics:
      itemType:
        type: number
  # Calculate middle index
  halve:
    operator: slang.eval
    generics:
      paramsMap:
        type: map
        map:
          x:
            type: number
    properties:
      expression: floor(x/2)
  # Take middle value from sorted stream
  takenth:
    operator: slang.stream.takeNth
    properties:
      default: null

connections:
  (:
  - (sorter
  - (length
  length):
  - x(halve
  sorter):
  - items(takenth
  halve):
  - index(takenth
  takenth)item:
  - )
