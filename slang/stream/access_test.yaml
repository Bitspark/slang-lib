# Stream length test
---
operatorFile: access.yaml
testCases:
- name: Simple
  generics:
    keyType:
      type: string
    valueType:
      type: number
  properties:
    default: null
  data:
    in:
    - {key: "b", stream: [{key: "a", value: 1}, {key: "b", value: 2}]}
    - {key: "b", stream: [{key: "a", value: 3}, {key: "b", value: 6}, {key: "c", value: 1}]}
    - {key: "b", stream: [{key: "a", value: 3}, {key: "c", value: 1}]}
    out:
    - 2
    - 6
    - null
- name: Complex
  generics:
    keyType:
      type: string
    valueType:
      type: map
      map:
        a:
          type: number
        b:
          type: boolean
  properties:
    default: {a: -1, b: false}
  data:
    in:
    - {key: "b", stream: [{key: "a", value: {a: 1, b: true}}, {key: "b", value: {a: 1, b: false}}, {key: "c", value: {a: 3, b: true}}]}
    - {key: "", stream: [{key: "a", value: {a: 1, b: true}}, {key: "b", value: {a: 1, b: false}}, {key: "c", value: {a: 3, b: true}}]}
    out:
    - {a: 1, b: false}
    - {a: -1, b: false}