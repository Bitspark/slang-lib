services:
  main:
    in:
      type: stream
      stream:
        type: map
        map:
          key:
            type: generic
            generic: keyType
          value:
            type: generic
            generic: valueType
    out:
      type: generic
      generic: valueType

properties:
  key:
    type: generic
    generic: keyType
  default:
    type: generic
    generic: valueType

operators:
  key:
    operator: slang.const
    generics:
      valueType:
        type: generic
        generic: keyType
    properties:
      value: $key
  access:
    operator: .access
    generics:
      keyType:
        type: generic
        generic: keyType
      valueType:
        type: generic
        generic: valueType
    properties:
      default: $default

connections:
  (:
  - (key
  ~(:
  - stream.~(access
  key):
  - key(access
  access):
  - )